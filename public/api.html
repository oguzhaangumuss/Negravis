<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Negravis API - Interactive Oracle Interface</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0a0a23 0%, #1a1a2e 50%, #16213e 100%);
            color: #ccd6f6;
            min-height: 100vh;
            overflow-x: hidden;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Header */
        .header {
            padding: 20px 0;
            border-bottom: 1px solid rgba(100, 255, 218, 0.1);
            background: rgba(10, 10, 35, 0.8);
            backdrop-filter: blur(10px);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 1.8rem;
            font-weight: bold;
            color: #64ffda;
            text-decoration: none;
        }

        .nav-links {
            display: flex;
            gap: 30px;
            list-style: none;
        }

        .nav-links a {
            color: #ccd6f6;
            text-decoration: none;
            transition: color 0.3s ease;
        }

        .nav-links a:hover {
            color: #64ffda;
        }

        /* Main Layout */
        .main-layout {
            display: flex;
            justify-content: center;
            align-items: flex-start;
            padding: 30px 0;
            min-height: calc(100vh - 100px);
        }



        /* Chatbot Panel */
        .chatbot-panel {
            background: rgba(26, 26, 46, 0.6);
            border-radius: 15px;
            border: 1px solid rgba(100, 255, 218, 0.1);
            backdrop-filter: blur(10px);
            display: flex;
            flex-direction: column;
            width: 100%;
            max-width: 600px;
            height: 85vh;
        }

        .chatbot-header {
            padding: 20px;
            border-bottom: 1px solid rgba(100, 255, 218, 0.1);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .chatbot-title {
            color: #64ffda;
            font-size: 1.3rem;
            font-weight: bold;
        }

        .status-indicator {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: #00ff7f;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }

        .chat-messages {
            flex: 1;
            padding: 20px;
            max-height: 400px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .message {
            padding: 12px 16px;
            border-radius: 15px;
            max-width: 85%;
            word-wrap: break-word;
        }

        .message.user {
            background: rgba(100, 255, 218, 0.1);
            border: 1px solid rgba(100, 255, 218, 0.3);
            align-self: flex-end;
            color: #64ffda;
        }

        .message.bot {
            background: rgba(102, 126, 234, 0.1);
            border: 1px solid rgba(102, 126, 234, 0.3);
            align-self: flex-start;
            color: #ccd6f6;
        }

        .chat-input-container {
            padding: 20px;
            border-top: 1px solid rgba(100, 255, 218, 0.1);
        }

        .chat-input {
            width: 100%;
            padding: 12px 16px;
            background: rgba(22, 33, 62, 0.8);
            border: 1px solid rgba(100, 255, 218, 0.3);
            border-radius: 25px;
            color: #ccd6f6;
            font-size: 0.9rem;
            outline: none;
            transition: border-color 0.3s ease;
        }

        .chat-input:focus {
            border-color: #64ffda;
        }

        .chat-input::placeholder {
            color: #8892b0;
        }

        .send-button {
            position: absolute;
            right: 25px;
            top: 50%;
            transform: translateY(-50%);
            background: #64ffda;
            color: #0a0a23;
            border: none;
            border-radius: 50%;
            width: 35px;
            height: 35px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.3s ease;
        }

        .send-button:hover {
            background: #4ecdc4;
        }

        /* Agent Selection */
        .agent-selection {
            padding: 20px;
            border-bottom: 1px solid rgba(100, 255, 218, 0.1);
            background: rgba(22, 33, 62, 0.3);
        }

        .agent-label {
            display: block;
            color: #64ffda;
            font-size: 0.9rem;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .agent-dropdown {
            width: 100%;
            padding: 12px 16px;
            background: rgba(10, 10, 35, 0.8);
            border: 1px solid rgba(100, 255, 218, 0.3);
            border-radius: 8px;
            color: #ccd6f6;
            font-size: 0.9rem;
            outline: none;
            transition: border-color 0.3s ease;
            margin-bottom: 15px;
        }

        .agent-dropdown:focus {
            border-color: #64ffda;
        }

        .agent-dropdown option {
            background: #0a0a23;
            color: #ccd6f6;
            padding: 10px;
        }

        .launch-button-container {
            display: flex;
            justify-content: center;
        }

        .launch-button {
            background: linear-gradient(135deg, #64ffda 0%, #4ecdc4 100%);
            color: #0a0a23;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            font-size: 0.9rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(100, 255, 218, 0.3);
        }

        .launch-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(100, 255, 218, 0.4);
        }

        .launch-button:active {
            transform: translateY(0);
        }

        /* Quick Actions */
        .quick-actions {
            padding: 0 20px 20px;
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .quick-action {
            background: rgba(100, 255, 218, 0.1);
            border: 1px solid rgba(100, 255, 218, 0.3);
            color: #64ffda;
            padding: 6px 12px;
            border-radius: 15px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .quick-action:hover {
            background: rgba(100, 255, 218, 0.2);
            transform: translateY(-1px);
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .nav-links {
                display: none;
            }

            .chatbot-panel {
                margin: 0 20px;
                height: 80vh;
            }

            .main-layout {
                padding: 20px 0;
            }
        }

        /* Loading Animation */
        .typing-indicator {
            display: none;
            align-items: center;
            gap: 5px;
            color: #8892b0;
            font-style: italic;
        }

        .typing-dots {
            display: flex;
            gap: 3px;
        }

        .typing-dot {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: #64ffda;
            animation: typing 1.4s infinite;
        }

        .typing-dot:nth-child(2) {
            animation-delay: 0.2s;
        }

        .typing-dot:nth-child(3) {
            animation-delay: 0.4s;
        }

        @keyframes typing {
            0%, 60%, 100% {
                transform: translateY(0);
                opacity: 0.4;
            }
            30% {
                transform: translateY(-10px);
                opacity: 1;
            }
        }

        /* Additional Animations */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes slideInLeft {
            from {
                opacity: 0;
                transform: translateX(-50px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(50px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(180deg); }
        }

        @keyframes messageSlide {
            from {
                opacity: 0;
                transform: translateY(20px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        @keyframes glow {
            0%, 100% {
                box-shadow: 0 0 20px rgba(102, 126, 234, 0.3);
            }
            50% {
                box-shadow: 0 0 30px rgba(102, 126, 234, 0.6);
            }
        }

        .fade-in {
            animation: fadeInUp 0.8s ease-out;
        }

        .slide-in-left {
            animation: slideInLeft 0.6s ease-out;
        }

        .slide-in-right {
            animation: slideInRight 0.6s ease-out;
        }

        .pulse-animation {
            animation: pulse 2s infinite;
        }

        .glow-animation {
            animation: glow 2s ease-in-out infinite;
        }

        /* Particles Background */
        .particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            z-index: -1;
            pointer-events: none;
        }

        .particle {
            position: absolute;
            background: rgba(102, 126, 234, 0.1);
            border-radius: 50%;
            animation: float 8s ease-in-out infinite;
        }

        /* Enhanced Button Animations */
        .agent-launch-btn {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .agent-launch-btn:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.4);
        }

        .agent-launch-btn:active {
            transform: translateY(-1px) scale(1.02);
        }

        /* Message Animation */
        .message {
            animation: messageSlide 0.4s ease-out;
        }

        /* Typing Indicator Animation */
        .typing-indicator {
            animation: pulse 1.5s ease-in-out infinite;
        }

        /* Agent Selection Animation */
        .agent-selection {
            transition: all 0.3s ease;
        }

        .agent-selection:hover {
             transform: translateY(-2px);
             box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
         }

         /* Shake animation for errors */
         @keyframes shake {
             0%, 100% { transform: translateX(0); }
             25% { transform: translateX(-5px); }
             75% { transform: translateX(5px); }
         }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <nav class="nav container">
            <a href="/" class="logo">üîÆ Negravis API</a>
            <ul class="nav-links">
                <li><a href="/">Home</a></li>
                <li><a href="/docs">Documentation</a></li>
                <li><a href="/oracle">Oracle Interface</a></li>
                <li><a href="https://github.com/Drehalas/Negravis" target="_blank">GitHub</a></li>
            </ul>
        </nav>
    </header>

    <!-- Main Content -->
    <div class="particles">
        <div class="particle" style="left: 10%; animation-delay: 0s; width: 8px; height: 8px;"></div>
        <div class="particle" style="left: 20%; animation-delay: 1s; width: 12px; height: 12px;"></div>
        <div class="particle" style="left: 30%; animation-delay: 2s; width: 6px; height: 6px;"></div>
        <div class="particle" style="left: 40%; animation-delay: 3s; width: 10px; height: 10px;"></div>
        <div class="particle" style="left: 50%; animation-delay: 4s; width: 14px; height: 14px;"></div>
        <div class="particle" style="left: 60%; animation-delay: 5s; width: 9px; height: 9px;"></div>
        <div class="particle" style="left: 70%; animation-delay: 6s; width: 11px; height: 11px;"></div>
        <div class="particle" style="left: 80%; animation-delay: 7s; width: 7px; height: 7px;"></div>
        <div class="particle" style="left: 90%; animation-delay: 8s; width: 13px; height: 13px;"></div>
    </div>
    <div class="container">
        <div class="main-layout fade-in">
            <!-- Oracle Chatbot Panel -->
            <div class="chatbot-panel slide-in-right">
                <div class="chatbot-header">
                    <div class="status-indicator"></div>
                    <div class="chatbot-title">Oracle Assistant</div>
                </div>

                <!-- Agent Selection -->
                <div class="agent-selection slide-in-left">
                    <label for="agentSelect" class="agent-label">Select AI Agent:</label>
                    <select id="agentSelect" class="agent-dropdown">
                        <option value="oracle-assistant">üîÆ Oracle Assistant (Default)</option>
                        <option value="llama-3.3-70b">ü¶ô Llama-3.3-70B-Instruct</option>
                        <option value="deepseek-r1-70b">üß† DeepSeek-R1-70B</option>
                        <option value="technical-advisor">‚öôÔ∏è Technical Advisor</option>
                        <option value="api-helper">üìö API Documentation Helper</option>
                    </select>
                    <div class="launch-button-container">
                        <button class="launch-button agent-launch-btn" onclick="launchAgent()">üöÄ Launch Agent</button>
                    </div>
                </div>

                <div class="chat-messages" id="chatMessages">
                    <!-- Messages will be populated by JavaScript -->
                </div>

                <div class="quick-actions">
                    <div class="quick-action" onclick="sendQuickMessage('Check my balance')">üí∞ Check Balance</div>
                    <div class="quick-action" onclick="sendQuickMessage('List AI services')">ü§ñ List Services</div>
                    <div class="quick-action" onclick="sendQuickMessage('Test chat with AI')">üí¨ Test Chat</div>
                    <div class="quick-action" onclick="sendQuickMessage('Show providers')">üîó Providers</div>
                </div>

                <div class="typing-indicator" id="typingIndicator">
                    <span>Oracle is thinking</span>
                    <div class="typing-dots">
                        <div class="typing-dot"></div>
                        <div class="typing-dot"></div>
                        <div class="typing-dot"></div>
                    </div>
                </div>

                <div class="chat-input-container" style="position: relative;">
                    <input type="text" class="chat-input" id="chatInput" placeholder="Ask about our API or test a service..." onkeypress="handleKeyPress(event)">
                    <button class="send-button" onclick="sendMessage()">‚û§</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        const chatMessages = document.getElementById('chatMessages');
        const chatInput = document.getElementById('chatInput');
        const typingIndicator = document.getElementById('typingIndicator');

        function addMessage(content, isUser = false) {
            const message = document.createElement('div');
            message.className = `message ${isUser ? 'user' : 'bot'}`;
            message.textContent = content;
            chatMessages.appendChild(message);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        function showTyping() {
            typingIndicator.style.display = 'flex';
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        function hideTyping() {
            typingIndicator.style.display = 'none';
        }

        async function sendMessage() {
            const message = chatInput.value.trim();
            if (!message) return;

            if (agentLaunched) {
                // Add user message with animation
                addMessageAnimated(message, true);
                chatInput.value = '';
                
                // Add enhanced typing indicator with animation
                showTyping();
                
                // Simulate response delay with random timing for realism
                const responseDelay = Math.random() * 1000 + 1500;
                setTimeout(async () => {
                    hideTyping();
                    const response = await processMessage(message);
                    addMessageAnimated(response);
                }, responseDelay);
            } else {
                // Shake the input if no agent is launched
                chatInput.style.animation = 'shake 0.5s ease-in-out';
                setTimeout(() => chatInput.style.animation = '', 500);
            }
        }

        function sendQuickMessage(message) {
            chatInput.value = message;
            sendMessage();
        }

        function handleKeyPress(event) {
            if (event.key === 'Enter') {
                sendMessage();
            }
        }

        async function processMessage(message) {
            const lowerMessage = message.toLowerCase();

            if (lowerMessage.includes('balance')) {
                try {
                    const response = await fetch('/api/account/balance');
                    if (response.ok) {
                        const data = await response.json();
                        return `üí∞ Your current balance: ${data.balance || 'Loading...'} tokens. Ledger status: ${data.status || 'Active'}`;
                    }
                } catch (error) {
                    return '‚ö†Ô∏è Unable to fetch balance. Please ensure your wallet is connected and try again.';
                }
            }

            if (lowerMessage.includes('services') || lowerMessage.includes('list')) {
                try {
                    const response = await fetch('/api/services/list');
                    if (response.ok) {
                        const data = await response.json();
                        return `ü§ñ Available AI Services:\n‚Ä¢ Llama-3.3-70B-Instruct\n‚Ä¢ DeepSeek-R1-70B\n\nAll services are TEE-verified and ready for use!`;
                    }
                } catch (error) {
                    return 'ü§ñ Available AI Services:\n‚Ä¢ Llama-3.3-70B-Instruct\n‚Ä¢ DeepSeek-R1-70B\n\nBoth models are TEE-verified and powered by 0G Compute Network.';
                }
            }

            if (lowerMessage.includes('chat') || lowerMessage.includes('test')) {
                return `üí¨ To test AI chat, you can send a POST request to /api/services/chat with:\n\n{\n  "model": "llama-3.3-70b-instruct",\n  "messages": [{"role": "user", "content": "Hello!"}]\n}\n\nThe response will include TEE verification and payment details.`;
            }

            if (lowerMessage.includes('providers')) {
                try {
                    const response = await fetch('/api/services/providers');
                    if (response.ok) {
                        return `üîó Service providers are active and acknowledged. All computations are verified through TEE (Trusted Execution Environment).`;
                    }
                } catch (error) {
                    return 'üîó Service providers are managed through 0G Compute Network with TEE verification for trustless execution.';
                }
            }

            if (lowerMessage.includes('help') || lowerMessage.includes('what')) {
                return `üîÆ I can help you with:\n\n‚Ä¢ Check account balance and ledger status\n‚Ä¢ List available AI services\n‚Ä¢ Test chat functionality\n‚Ä¢ View provider information\n‚Ä¢ Explain API endpoints\n\nTry asking "Check my balance" or "List AI services"!`;
            }

            if (lowerMessage.includes('0g') || lowerMessage.includes('fluence')) {
                return `üöÄ Negravis is powered by:\n\n‚Ä¢ 0G.AI: Modular AI-first blockchain with scalable execution\n‚Ä¢ Fluence Network: Decentralized compute platform\n\nThis combination provides TEE verification, micropayments, and trustless AI inference.`;
            }

            // Default response
            return `ü§î I understand you're asking about "${message}". Try using the quick actions above or ask about:\n\n‚Ä¢ Account balance\n‚Ä¢ Available services\n‚Ä¢ Testing chat functionality\n‚Ä¢ Provider status\n\nOr visit /docs for complete API documentation!`;
        }

        let currentAgent = 'oracle-assistant';
        let agentLaunched = false;

        function launchAgent() {
            const agentSelect = document.getElementById('agentSelect');
            if (!agentSelect.value) {
                // Add shake animation to button
                const button = document.querySelector('.launch-button');
                button.style.animation = 'shake 0.5s ease-in-out';
                setTimeout(() => button.style.animation = '', 500);
                alert('Please select an agent first!');
                return;
            }

            currentAgent = agentSelect.value;
            agentLaunched = true;
            
            // Add loading animation
            const button = document.querySelector('.launch-button');
            button.textContent = 'üöÄ Launching...';
            button.style.transform = 'scale(0.95)';
            
            setTimeout(() => {
                // Clear chat messages with fade out
                chatMessages.style.opacity = '0.3';
                
                setTimeout(() => {
                    chatMessages.innerHTML = '';
                    chatMessages.style.opacity = '1';
                    
                    // Update chatbot title with animation
                    const chatbotTitle = document.querySelector('.chatbot-title');
                    chatbotTitle.style.transform = 'scale(1.1)';
                    chatbotTitle.style.transition = 'all 0.3s ease';
                    
                    const agentNames = {
                        'oracle-assistant': 'Oracle Assistant',
                        'llama-3.3-70b': 'Llama-3.3-70B',
                        'deepseek-r1-70b': 'DeepSeek-R1-70B',
                        'technical-advisor': 'Technical Advisor',
                        'api-helper': 'API Helper'
                    };
                    
                    chatbotTitle.textContent = agentNames[currentAgent];
                    
                    setTimeout(() => {
                        chatbotTitle.style.transform = 'scale(1)';
                    }, 200);
                    
                    // Add agent-specific welcome message with animation
                    const welcomeMessages = {
                        'oracle-assistant': 'üîÆ Oracle Assistant activated! I can help you test our AI services, check account balances, and explore our decentralized infrastructure. What would you like to try?',
                        'llama-3.3-70b': 'ü¶ô Llama-3.3-70B-Instruct model is now active! I\'m a powerful language model running on 0G Compute Network with TEE verification. Ask me anything!',
                        'deepseek-r1-70b': 'üß† DeepSeek-R1-70B model activated! I specialize in reasoning and problem-solving. I\'m running on decentralized infrastructure with full TEE verification.',
                        'technical-advisor': '‚öôÔ∏è Technical Advisor ready! I can help you with API integration, troubleshooting, and understanding the 0G Compute Network architecture.',
                        'api-helper': 'üìö API Documentation Helper online! I can guide you through our endpoints, provide code examples, and help with implementation details.'
                    };
                    
                    setTimeout(() => {
                        addMessageAnimated(welcomeMessages[currentAgent]);
                    }, 300);
                    
                    // Reset button
                    button.textContent = 'üöÄ Launch Agent';
                    button.style.transform = 'scale(1)';
                }, 300);
            }, 800);
            
            // Focus on input
            chatInput.focus();
        }

        async function processMessage(message) {
            if (!agentLaunched) {
                return 'üöÄ Please select and launch an agent first using the dropdown above!';
            }
            
            const lowerMessage = message.toLowerCase();
            
            // Agent-specific responses
            if (currentAgent === 'llama-3.3-70b') {
                try {
                    const response = await fetch('/api/services/oracle/chat', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            message: message,
                            provider: 'llama-3.3-70b-instruct'
                        })
                    });
                    
                    if (response.ok) {
                        const data = await response.json();
                        if (data.success) {
                            const costInfo = data.cost > 0 ? ` (Cost: ${data.cost.toFixed(6)} OG)` : '';
                            return `ü¶ô **Llama-3.3-70B Response:**\n\n${data.response}${costInfo}`;
                        } else {
                            return `ü¶ô ‚ö†Ô∏è Error: ${data.error || 'Failed to get response from Llama model'}`;
                        }
                    } else {
                        return 'ü¶ô ‚ö†Ô∏è Unable to connect to Llama-3.3-70B service. Please try again.';
                    }
                } catch (error) {
                    console.error('Llama API error:', error);
                    return `ü¶ô [Fallback Response] I understand you\'re asking about "${message}". As a large language model running on decentralized infrastructure, I can help with complex reasoning, coding, and analysis tasks. (Note: Live AI service temporarily unavailable)`;
                }
            }
            
            if (currentAgent === 'deepseek-r1-70b') {
                try {
                    const response = await fetch('/api/services/oracle/chat', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            message: message,
                            provider: 'deepseek-r1-70b'
                        })
                    });
                    
                    if (response.ok) {
                        const data = await response.json();
                        if (data.success) {
                            const costInfo = data.cost > 0 ? ` (Cost: ${data.cost.toFixed(6)} OG)` : '';
                            return `üß† **DeepSeek-R1-70B Analysis:**\n\n${data.response}${costInfo}`;
                        } else {
                            return `üß† ‚ö†Ô∏è Error: ${data.error || 'Failed to get response from DeepSeek model'}`;
                        }
                    } else {
                        return 'üß† ‚ö†Ô∏è Unable to connect to DeepSeek-R1-70B service. Please try again.';
                    }
                } catch (error) {
                    console.error('DeepSeek API error:', error);
                    return `üß† [Fallback Response] Let me reason through "${message}"... This appears to be a query that requires systematic analysis. I\'m designed for advanced reasoning tasks on the 0G Compute Network. (Note: Live AI service temporarily unavailable)`;
                }
            }
            
            if (currentAgent === 'technical-advisor') {
                if (lowerMessage.includes('integration') || lowerMessage.includes('api')) {
                    return '‚öôÔ∏è For API integration, start with authentication, then use our REST endpoints. Check /docs for OpenAPI specs. Need help with specific endpoints or error handling?';
                }
                if (lowerMessage.includes('error') || lowerMessage.includes('troubleshoot')) {
                    return '‚öôÔ∏è Common issues: 1) Check API keys 2) Verify endpoint URLs 3) Ensure proper request format 4) Check network connectivity. What specific error are you encountering?';
                }
                return `‚öôÔ∏è [Technical Analysis] Regarding "${message}" - I can help with architecture, implementation, debugging, and optimization. What technical aspect needs attention?`;
            }
            
            if (currentAgent === 'api-helper') {
                if (lowerMessage.includes('endpoint') || lowerMessage.includes('documentation')) {
                    return 'üìö Our main endpoints: /api/account/balance (GET), /api/services/list (GET), /api/services/chat (POST), /api/services/providers (GET). Each has detailed docs at /docs with examples!';
                }
                return `üìö [API Documentation] For "${message}", check our comprehensive docs at /docs. I can provide specific examples, parameter details, and response formats. What endpoint interests you?`;
            }
            
            // Default Oracle Assistant responses (existing logic)
            if (lowerMessage.includes('balance') || lowerMessage.includes('status')) {
                try {
                    const response = await fetch('/api/services/oracle/status');
                    if (response.ok) {
                        const data = await response.json();
                        if (data.success && data.account) {
                            return `üí∞ **Oracle Account Status:**\n\n‚Ä¢ Wallet: ${data.account.walletAddress || 'Not connected'}\n‚Ä¢ ETH Balance: ${data.account.ethBalance || '0'} ETH\n‚Ä¢ Ledger Balance: ${data.account.ledgerBalance || '0'} OG\n‚Ä¢ RPC: ${data.account.connectedRPC || 'Unknown'}\n‚Ä¢ Service Ready: ${data.ready ? '‚úÖ Yes' : '‚ùå No'}`;
                        }
                    }
                    // Fallback to old endpoint
                    const fallbackResponse = await fetch('/api/account/balance');
                    if (fallbackResponse.ok) {
                        const data = await fallbackResponse.json();
                        return `üí∞ Your current balance: ${data.balance || 'Loading...'} tokens. Ledger status: ${data.status || 'Active'}`;
                    }
                } catch (error) {
                    return '‚ö†Ô∏è Unable to fetch balance. Please ensure your wallet is connected and try again.';
                }
            }

            if (lowerMessage.includes('services') || lowerMessage.includes('list') || lowerMessage.includes('models')) {
                try {
                    const response = await fetch('/api/services/oracle/models');
                    if (response.ok) {
                        const data = await response.json();
                        if (data.success && data.models) {
                            let modelList = 'ü§ñ **Available Oracle AI Models:**\n\n';
                            data.models.forEach(model => {
                                modelList += `‚Ä¢ **${model.name}**\n  Provider: ${model.provider}\n  ${model.description}\n\n`;
                            });
                            modelList += 'All services are TEE-verified and ready for use!';
                            return modelList;
                        }
                    }
                    // Fallback to old endpoint
                    const fallbackResponse = await fetch('/api/services/list');
                    if (fallbackResponse.ok) {
                        const data = await fallbackResponse.json();
                        return `ü§ñ Available AI Services:\n‚Ä¢ Llama-3.3-70B-Instruct\n‚Ä¢ DeepSeek-R1-70B\n\nAll services are TEE-verified and ready for use!`;
                    }
                } catch (error) {
                    return 'ü§ñ Available AI Services:\n‚Ä¢ Llama-3.3-70B-Instruct\n‚Ä¢ DeepSeek-R1-70B\n\nBoth models are TEE-verified and powered by 0G Compute Network.';
                }
            }

            if (lowerMessage.includes('chat') || lowerMessage.includes('test')) {
                return `üí¨ To test AI chat, you can send a POST request to /api/services/chat with:\n\n{\n  "model": "llama-3.3-70b-instruct",\n  "messages": [{"role": "user", "content": "Hello!"}]\n}\n\nThe response will include TEE verification and payment details.`;
            }

            if (lowerMessage.includes('providers')) {
                try {
                    const response = await fetch('/api/services/providers');
                    if (response.ok) {
                        return `üîó Service providers are active and acknowledged. All computations are verified through TEE (Trusted Execution Environment).`;
                    }
                } catch (error) {
                    return 'üîó Service providers are managed through 0G Compute Network with TEE verification for trustless execution.';
                }
            }

            if (lowerMessage.includes('help') || lowerMessage.includes('what')) {
                return `üîÆ I can help you with:\n\n‚Ä¢ Check account balance and ledger status\n‚Ä¢ List available AI services\n‚Ä¢ Test chat functionality\n‚Ä¢ View provider information\n‚Ä¢ Explain API endpoints\n\nTry asking "Check my balance" or "List AI services"!`;
            }

            if (lowerMessage.includes('0g') || lowerMessage.includes('fluence')) {
                return `üöÄ Negravis is powered by:\n\n‚Ä¢ 0G.AI: Modular AI-first blockchain with scalable execution\n‚Ä¢ Fluence Network: Decentralized compute platform\n\nThis combination provides TEE verification, micropayments, and trustless AI inference.`;
            }

            // Default response
            return `ü§î I understand you're asking about "${message}". Try using the quick actions above or ask about:\n\n‚Ä¢ Account balance\n‚Ä¢ Available services\n‚Ä¢ Testing chat functionality\n‚Ä¢ Provider status\n\nOr visit /docs for complete API documentation!`;
        }

        // Dynamic particle generation
        function createParticle() {
            const particle = document.createElement('div');
            particle.className = 'particle';
            particle.style.left = Math.random() * 100 + '%';
            particle.style.animationDelay = Math.random() * 8 + 's';
            particle.style.width = particle.style.height = (Math.random() * 12 + 6) + 'px';
            particle.style.animationDuration = (Math.random() * 4 + 6) + 's';
            document.querySelector('.particles').appendChild(particle);

            setTimeout(() => {
                if (particle.parentNode) {
                    particle.remove();
                }
            }, 8000);
        }

        // Enhanced addMessage function with animations
        function addMessageAnimated(message, isUser = false) {
            const messagesContainer = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${isUser ? 'user' : 'bot'}`;
            messageDiv.textContent = message;
            
            // Add animation class
            messageDiv.style.opacity = '0';
            messageDiv.style.transform = 'translateY(20px) scale(0.95)';
            
            messagesContainer.appendChild(messageDiv);
            
            // Trigger animation
            setTimeout(() => {
                messageDiv.style.transition = 'all 0.4s ease-out';
                messageDiv.style.opacity = '1';
                messageDiv.style.transform = 'translateY(0) scale(1)';
            }, 10);
            
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        // Initialize with a welcome state
        document.addEventListener('DOMContentLoaded', () => {
            // Create initial particles
            for (let i = 0; i < 5; i++) {
                setTimeout(createParticle, i * 1000);
            }
            
            // Continue creating particles
            setInterval(createParticle, 3000);
            
            // Show initial message with animation
            setTimeout(() => {
                addMessageAnimated('üîÆ Welcome to Negravis Oracle! This is your gateway to decentralized AI services powered by 0G.AI and Fluence Network. Please select an AI agent from the dropdown above and click "Launch Agent" to begin your session.');
            }, 500);
        });
    </script>
</body>
</html>